---
layout: post
title: TURBO码和LDPC码
categories: [通信, 信道编码]
description: 基础的信道编码
keywords: 通信, 信道编码
mermaid: false
sequence: false
flow: false
mathjax: true
mindmap: false
mindmap2: false
---

## 一、信道编码基础

前文介绍了**重复码**、**奇偶校验码**、**汉明码**和**卷积码**等基础信道编码方法，并结合 MATLAB 示例演示了各自的编码与译码过程。

本文将介绍 **TURBO** 和 **LDPC** 两种在4G和5G中广泛应用的前向纠错码。

以下将先介绍一些基础通信理论。

### 1. 奈奎斯特采样定理

要完整、无失真地采样一个信号，**采样频率**必须至少是信号中最高频率的两倍。

在无线通信或有线通信中，奈奎斯特定理也用于决定：

**在某个带宽范围内最多能传多少比特/秒？**

✅ 奈奎斯特码元速率（Nyquist symbol rate）：

在**无码间干扰**（ISI）的理想情况下，最大码元率 = 2 × 带宽

即：

**在带宽为 B Hz 的信道中，每秒最多可以无失真地传 2B 个码元（symbols）。**

### 2. 香农极限公式

香农信道容量公式（Shannon Capacity）：

$$
C < B \cdot \log _2\left(1+\frac{S}{N}\right)
$$

其中：

- 𝐶：信道容量（bit/s），即单位时间内可靠传输的最大信息速率
- 𝐵：信道带宽（Hz）
- 𝑆/𝑁：信噪比（功率比）

**描述了在给定带宽和信噪比下通信系统的理论极限传输速率**。超过该速率将无法实现无错传输。

### 3. 与码率的关系（Eb/N0 形式）

我们关心的是在**单位比特能量**（𝐸𝑏）和**噪声功率谱密度**（𝑁0）下的表现：

目标是从香农公式推出**误码性能相关的 Eb/N0 极限表达式**。

推导过程如下：

- 定义 $$R$$ 为信道比特率（bit/s）：

$$
R = C
$$

- 代入香农公式

$$
R < B \cdot \log _2\left(1+\frac{S}{N}\right)
$$

- 引入 Eb/N0：

  - 平均每比特能量为 $$E_b=\frac{S}{R}$$
  - 单位噪声功率谱密度 $$N_0=\frac{N}{B}$$
  - 因此：
  
$$
\frac{E_b}{N_0}=\frac{S}{R} \cdot \frac{B}{N} \Rightarrow \frac{S}{N}=\frac{R}{B} \cdot \frac{E_b}{N_0}
$$

- 代入香农公式并变换：

$$
R<B\log _2\left(1+\frac{R}{B} \cdot \frac{E_b}{N_0}\right)
$$

- 定义带宽归一化速率（即频谱效率）

$$
R_l=\frac{R}{2 B}
$$

- 于是得到：

$$
2R_l<\log _2\left(1+2R_l \cdot \frac{E_b}{N_0}\right)
$$

- 整理得到**香农极限计算公式**：

$$
\frac{E_b}{N_0}>\frac{2^{2 R_l}-1}{2 R_l}
$$

香农极限表示了在 AWGN 信道中实现可靠通信所需的最小 𝐸𝑏/𝑁0（每比特信噪比）门限.

可以计算得到 1/2 归一化频谱效率下的香农极限为 0 dB。

而当频谱效率趋近于 0（即**码率远小于带宽**）时，香农极限趋于理论下限 -1.59 dB。

这表明：**即便采用无限低速率传输，每个比特的能量也不能低于该极限**，这是任何数字通信系统都无法逾越的物理界限。

## 二、Turbo码

### 1. 概述

Turbo码由 Claude Berrou 等人于 1993年提出，是一种接近**香农极限性能**的**纠错编码**，被称为信道编码领域的里程碑。

- 采用并行级联卷积编码结构；
- 解码采用软输入软输出迭代译码算法；
- 可逼近理论极限误码性能（1/2码率下，其性能距离 Shannon 极限仅约 0.7 dB）；
- 解决传统卷积码在低信噪比下性能不佳的问题；
- 引领现代纠错编码体系的发展，促进 3G/4G/5G 等系统演进。

### 2. 系统码与非系统码

| 项目    | 系统码                      | 非系统码                     |
| ----- | ------------------------ | ------------------------ |
| 定义    | 原始信息比特 **直接出现在输出码字中**    | 原始信息不直接出现，仅存在于编码后新的冗余比特中 |
| 结构特征  | 保留原始输入比特，添加校验比特          | 所有输出比特均由编码器结构组合生成        |
| 信息保留性 | ✅ 保留原始数据                 | ❌ 不保留                    |

#### (a) 经典非系统码结构（Classical Non-Systematic Code）

![非系统码](/images/2025-07-24-Turbo_LDPC/非系统码.jpg)

上图给出一个经典非系统码的例子，其特点如下：

- ✅ 前馈结构（Feedforward）：编码器结构只依赖当前及过去输入，无内部状态反馈；
- ❌ 无记忆性：编码器输出仅依赖于当前输入，不能形成迭代反馈链路；

其时域表达式为：

$$
\begin{gathered}
x_k=d_k+d_{k-1}+d_{k-2}+d_{k-3}+d_{k-4} \\
y_k=d_k+d_{k-4}
\end{gathered}
$$

生成多项式：

$$
\begin{gathered}
g_x(D)=1+D+D^2+D^3+D^4 \\
g_y(D)=1+D^4
\end{gathered}
$$

输出的多项式乘法表达式也可以写为：

$$
\begin{gathered}
x(D)=d(D) \cdot g_x(D) \\
y(D)=d(D) \cdot g_y(D)
\end{gathered}
$$

#### (b) 递归系统码（Recursive Systematic Code, RSC）

RSC 是 Turbo 码中采用的编码器结构，如下图所示：

![递归系统码](/images/2025-07-24-Turbo_LDPC/递归系统码.jpg)

其有以下特性：

- ✅系统性：编码器输出中包含原始输入比特（称为系统比特）
- ✅递归性：编码器中包含反馈路径，输出依赖于当前输入和以往状态

相比非系统前馈码，RSC 编码器具有“记忆性”

其中 $$a_k$$ 项为：

$$
a_k=d_k+a_{k-1}+a_{k-2}+a_{k-3}+a_{k-4}
$$

- 说明：当前系统比特不仅取决于当前输入$$d_k$$，还受到前几位编码输出反馈影响。

由此 $$d_k$$ 可表示为：

$$
d_k=a_k+a_{k-1}+a_{k-2}+a_{k-3}+a_{k-4}
$$

多项式表示：

$$
d(D)=a(D) \cdot\left(1+D+D^2+D^3+D^4\right)
$$

校验比特 $$y_k$$ 输出：

$$
y_k = a_k+ a_{k-4}
$$

其多项式表示：

$$
y(D)=a(D) \cdot\left(1+D^4\right)
$$

联立得到：

$$
\frac{y(D)}{d(D)}=\frac{1+D^4}{1+D+D^2+D^3+D^4}
$$

于是 Turbo 编码器的生成多项式可写为：

$$
g(D)=\left(1, \frac{1+D^4}{1+D+D^2+D^3+D^4}\right)
$$

这里的两个分量含义为：

- 第一项1：系统比特（直接输出）；
- 第二项：校验比特（经过递归滤波器处理的编码输出）。

也可以使用**八进制**记法：

$$
G_1=37, G_2=21
$$

