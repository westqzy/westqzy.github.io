---
layout: post
title: 树莓派实现无线打印
categories: 摸鱼
description: 树莓派实现无线打印
keywords: 摸鱼
mermaid: false
sequence: false
flow: false
mathjax: true
mathjax: true
mindmap: false
mindmap2: false
---

想把实验室M1136 MFP 打印机改成无线打印机，查些网上的资料，树莓派+CUPS可以实现这个需求。

---

##  树莓派 + HP LaserJet M1136 打印服务器完整攻略

## 一、准备工作

* 硬件：

  * 树莓派 4（建议 2G/4G 内存以上）
  * microSD 卡 ≥ 16GB
  * USB 数据线（注意必须支持数据传输，不是充电线）
  * HP LaserJet M1136 MFP 打印机

* 软件：

  * Raspberry Pi Imager（官方烧录工具，Win/Mac/Linux 均可下载）
  * 树莓派 OS （推荐 Raspberry Pi OS 64-bit，Bookworm）

---

## 二、️烧录系统

1. 插入 SD 卡，打开 **Raspberry Pi Imager**。
2. 选择系统：`Raspberry Pi OS (64-bit)`。
3. 配置高级选项（⚙️ 图标）：

   * 启用 SSH
   * 设置用户名/密码（例如 `qzy` / `123456`）
   * 配置 Wi-Fi（填入家里 SSID + 密码）
   * 设置时区/键盘布局
4. 烧录完成后，将 SD 卡插入树莓派，接通电源。

---

## 三、初始配置

树莓派启动后，可以直接用 SSH 登录：

```bash
ssh qzy@raspberrypi
```

或者用分配的局域网 IP 登录。

更新系统：

```bash
sudo apt update && sudo apt full-upgrade -y
```

---

## 四、配置国内源

修改 apt 源，保证速度快（以清华源为例）：

```bash
sudo tee /etc/apt/sources.list <<'EOF'
deb http://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian/ bookworm-updates main contrib non-free non-free-firmware
deb http://mirrors.tuna.tsinghua.edu.cn/debian-security bookworm-security main contrib non-free non-free-firmware
EOF

sudo tee /etc/apt/sources.list.d/raspi.list <<'EOF'
deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ bookworm main
EOF
sudo apt update
```

---

## 五、安装打印服务

安装 CUPS（打印服务框架）和 HPLIP（HP 打印驱动工具）：

```bash
sudo apt install cups hplip printer-driver-hpcups -y
```

把当前用户加入打印组：

```bash
sudo usermod -aG lpadmin qzy
```

---

## 六、安装 HP 插件

HP LaserJet M1136 需要专有插件。直接下载 `.run` 文件：

```bash
wget https://www.openprinting.org/download/printdriver/auxfiles/HP/plugins/hplip-3.22.10-plugin.run -O ~/hplip-3.22.10-plugin.run
```

运行安装：

```bash
sudo hp-plugin -i
```

选择 `p`（指定路径），输入：

```
/home/qzy/hplip-3.22.10-plugin.run
```

如果提示 `.asc` 缺失，直接输入 `y` 继续即可。

---

## 七、连接打印机

插好 USB 数据线，确认树莓派能识别打印机：

```bash
lsusb | grep -i hp
```

然后运行：

```bash
sudo hp-setup -i
```

* 选择 USB → 自动检测到 **HP LaserJet M1136**
* 确认并安装 → 自动创建打印队列

---

## 八、配置 CUPS Web 界面

编辑配置文件允许远程访问：

```bash
sudo nano /etc/cups/cupsd.conf
```

找到以下几段：

```
<Location />
  Order allow,deny
  Allow @local
</Location>
```

以及：

```
Listen *:631
```

保存后重启：

```bash
sudo systemctl restart cups
```

现在在局域网电脑上访问：

```
http://raspberrypi.local:631
```

或者：

```
http://192.168.0.xxx:631
```

就能看到 CUPS Web 界面 → 打印机 → **Print Test Page**。

---

## 九、Windows 添加网络打印机

1. 打开 **控制面板 → 设备和打印机 → 添加打印机**。
2. 选择 **通过网络查找**，或手动输入：

   ```
   http://raspberrypi.local:631/printers/HP_LaserJet_Professional_M1136_MFP
   ```
3. 系统可能会让你选择驱动，选 **HP LaserJet M1136 (PCL)** 或用 Windows 自带驱动。

---

## 十、测试打印

在 Windows / 树莓派 上分别尝试：

```bash
echo "Hello from Raspberry Pi" | lp
```

以及 CUPS 网页的 **Print Test Page**。
如果能吐纸 → 配置成功 ✅

